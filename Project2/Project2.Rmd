---
title: "Project 2"
output:
  html_notebook: default
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
  word_document: default
---

#Introduction

This is Project 2 for STAT 557 2018 Spring by Meridith Bartley and Fei Jiang. The aim of this project is topractice the k-means algorithm and the k-nearest neighbor algorithm. In this project we applied {METHOD} to {WHAT TYPE} data in order to {ACHEIVE WHAT}. 

#Description of Data

The examined group comprised kernels belonging to three different varieties of wheat: Kama, Rosa and Canadian, 70 elements each, randomly selected for the experiment. High quality visualization of the internal kernel structure was detected using a soft X-ray technique. It is non-destructive and considerably cheaper than other more sophisticated imaging techniques like scanning microscopy or laser technology. The images were recorded on 13x18 cm X-ray KODAK plates. Studies were conducted using combine harvested wheat grain originating from experimental fields, explored at the Institute of Agrophysics of the Polish Academy of Sciences in Lublin. 

```{r packages to load, include=FALSE}
library(dplyr)
library(ggplot2)
library(grid)
library(gridExtra)
library(magrittr)
library(cluster)
library(fpc)
```


```{r load code and clean, include=FALSE, echo = F, message = F}
# Basic clearning of our dataset 
project2data <- read_delim("seeds_dataset.txt", 
     "\t", escape_double = FALSE, col_names = FALSE, 
     trim_ws = TRUE)

#add column names and true seed types
project2data <- project2data %>% 
                'colnames<-' (c("area", "perimeter", "compactness", 
                           "length", "width", "asymcoef", "groovelength",
                           "remove")) %>% 
                mutate(remove = NULL, 
                      type =  c(rep("kama", 70), rep("rosa", 70),
             
                                                  rep("canadian", 70)))
#shuffle rows
project2data <- project2data[sample(nrow(project2data),nrow(project2data)),] 


#rows with NA
na.idx = which(is.na(apply(project2data[, -8], 1, sum)))
project2data <- project2data[-na.idx, ]

```

## Exploritory Data Analysis

```{r EDA - Mer, echo=FALSE, message = F, results = 'hide', fig.keep='all', fig.width = 8}

varlist <- names(project2data)[-8]

customPlot <- function(varName) {

project2data %>% 
group_by_("type") %>% 
select_("type",varName) %>% 
ggplot(aes_string("type",varName)) + geom_boxplot() + 
   theme(axis.text.x = element_text(angle = 45, hjust = 1))

}

grid.arrange(grobs = lapply(varlist[1:4],customPlot))
grid.arrange(grobs = lapply(varlist[5:7],customPlot), ncol = 2)



```

#K-Means Algorithm

```{r}
km <- kmeans(project2data[, -8], 3)

knitr::kable(table(data.frame(project2data$type, km$cluster)))

plotcluster(project2data[, -8], km$cluster)

clusplot(project2data[, -8], km$cluster, color=TRUE, shade=TRUE, 
         labels=2, lines=0)

with(project2data[, -8], pairs(project2data[, -8], col=c(1:3)[km$cluster])) 


```


```{r}



WSS. <- sapply(1:15, function(i){return(kmeans(project2data[-na.idx, -8], centers = i)$tot.withinss)})
cbind(No.of.Cluters=1:15, WSS.)

plot(1:15, WSS., type="l", xlab = "No. of clusters", ylab = "Total WSS", main = "Scree Plot")

```




<!-- USEFUL LINKS
http://cowlet.org/2013/12/23/understanding-data-science-clustering-with-k-means-in-r.html
https://stats.stackexchange.com/questions/31083/how-to-produce-a-pretty-plot-of-the-results-of-k-means-cluster-analysis

-->